theory Test_User_AC_Functions
begin

builtins: hashing

usersorts: NAT

functions: one: -> NAT,
           plus: NAT NAT -> NAT [AC]

rule Emit1:
    [ Fr(~k) ]
  --[ Emitted1($A, $B, ~k) ]->
    [ !Ltk($A, $B, ~k)
    , Out(h($A, $B, ~k, plus(one, plus(one, one)))) ]

rule Recv1:
    [ !Ltk($A, $B, ~k)
    , In(h($A, $B, ~k, plus(x:NAT, one))) ]
  --[ Received1($A, $B, ~k) ]->
    [ ]

lemma Provable1:
    exists-trace
    "
    Ex A B k #i #j.
        Emitted1(A, B, k) @ #i
        & Received1(A, B, k) @ #j 
        & i < j
    "

end
